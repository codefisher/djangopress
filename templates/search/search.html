{% extends 'base.html' %}
{% load show_pagination %}
{% load highlight %}
{% load timezone %}

{% block page_title %}Search results for &#8220;{{ query|escape }}&#8221;{% endblock %}
{% block head_tags %}
    <link type="text/css" rel="stylesheet" href="/media/themes/default/search.css">
{% endblock %}

{% block content %}
    
    <form id="search-form" method="get" action=".">
        <div id="search-fields">
          {% for field in form %}
            {% if field.is_hidden %}
                {{ field }}
            {% else %}
                <span>{{ field.label_tag }} {{ field }}</span>
            {% endif %}
           {% endfor %}
            <input type="submit" value="Search">
        </div>

        {% if query %}
            <h3>Search results for &#8220;{{ query|escape }}&#8221;</h3>
            {% query_pagination page show_location=False %}
     </form>
            <ul id="search-results" class="content-box">
            {% for result in page.object_list %}
                <li>
                    <h3><a href="{{ result.object.get_absolute_url }}">{{ result.title }}</a></h3>
                    <span class="result-link">{{ result.object.get_absolute_url }}</span>
                    <p>
                        {% highlight result.text with query max_length 200 %}
                    </p>
                    <small>
                        {% if result.pub_date %}
                        {{ result.pub_date|user_timezone:user|date:"DATE_FORMAT" }}
                        {% endif %}
                        {% if result.author %}
                           by {{ result.author }}
                        {% endif %}
                    </small>
                </li>
            {% empty %}
                <li>No results found.</li>
            {% endfor %}
            </ul>

            {% query_pagination page %}
            
        {% else %}
            <p>
                No results found for &#8220;{{ query|escape }}&#8221;.
            </p>
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
{% endblock %}